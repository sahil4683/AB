<div class="admin-container">
  <h1>Admin Panel</h1>

  <div class="forms-section">
    <!-- Add Product Form -->
    <div class="form-card">
      <h2>Add Product</h2>
      <form [formGroup]="productForm" (ngSubmit)="onSubmitProduct()">
        <div class="form-group">
          <label for="productTitle">Title:</label>
          <input type="text" id="productTitle" formControlName="title" required>
        </div>

        <div class="form-group">
          <label for="productCasNumber">CAS Number:</label>
          <input type="text" id="productCasNumber" formControlName="casNumber">
        </div>

        <div class="form-group">
          <label for="productImageUrl">Image URL:</label>
          <input type="url" id="productImageUrl" formControlName="imageUrl">
        </div>

        <div class="form-group">
          <label for="productDescription">Description:</label>
          <textarea id="productDescription" formControlName="description" rows="3"></textarea>
        </div>

        <div class="form-group">
          <label for="productCategory">Category:</label>
          <select id="productCategory" formControlName="categoryId" required>
            <option value="">Select Category</option>
            @for (category of categories(); track category.id) {
              <option [value]="category.id">
                {{ category.name }}
              </option>
            }
          </select>
        </div>

        <button type="submit" [disabled]="!productForm.valid">Add Product</button>
      </form>
    </div>

    <!-- Add Category Form -->
    <div class="form-card">
      <h2>Add Category</h2>
      <form [formGroup]="categoryForm" (ngSubmit)="onSubmitCategory()">
        <div class="form-group">
          <label for="categoryName">Name:</label>
          <input type="text" id="categoryName" formControlName="name" required>
        </div>

        <div class="form-group">
          <label for="categorySlug">Slug:</label>
          <input type="text" id="categorySlug" formControlName="slug" required>
        </div>

        <div class="form-group">
          <label for="categoryUrl">URL:</label>
          <input type="text" id="categoryUrl" formControlName="url" required>
        </div>

        <button type="submit" [disabled]="!categoryForm.valid">Add Category</button>
      </form>
    </div>

  </div>

  <!-- Data Display Section -->
  <div class="data-section">
    <div class="data-card">
      <h2>Categories ({{ filteredCategories().length }})</h2>
      <div class="search-bar">
        <svg class="search-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
        </svg>
        <input
          type="text"
          class="search-input"
          placeholder="Search categories by name or slug..."
          (input)="categorySearch.set($any($event.target).value)"
          [value]="categorySearch()"
        />
      </div>
      <div class="data-list">
        @for (category of filteredCategories(); track category.id) {
          <div class="data-item">
            <div class="item-content">
              <strong>{{ category.name }}</strong>
              <br>
              <small>Slug: {{ category.slug }} | URL: {{ category.url }}</small>
            </div>
            <button class="delete-btn" (click)="deleteCategory(category.id, category.name)" title="Delete category">
              <svg fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"/>
              </svg>
            </button>
          </div>
        }
      </div>
    </div>

    <div class="data-card">
      <h2>Products ({{ filteredProducts().length }})</h2>
      <div class="search-bar">
        <svg class="search-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
        </svg>
        <input
          type="text"
          class="search-input"
          placeholder="Search products by title, CAS number, or category..."
          (input)="productSearch.set($any($event.target).value)"
          [value]="productSearch()"
        />
      </div>
      <div class="data-list">
        @for (product of filteredProducts(); track product.id) {
          <div class="data-item">
            <div class="item-content">
              <strong>{{ product.title }}</strong>
              <br>
              <small>CAS: {{ product.casNumber }} | Category: {{ product.category }}</small>
            </div>
            <button class="delete-btn" (click)="deleteProduct(product.id, product.title)" title="Delete product">
              <svg fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"/>
              </svg>
            </button>
          </div>
        }
      </div>
    </div>

    <!-- Contact Requests -->
    <div class="data-card full-width">
      <h2>Contact Requests ({{ filteredContactRequests().length }})</h2>
      <div class="search-bar">
        <svg class="search-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
        </svg>
        <input
          type="text"
          class="search-input"
          placeholder="Search by phone number or country code..."
          (input)="contactSearch.set($any($event.target).value)"
          [value]="contactSearch()"
        />
      </div>
      <div class="data-list">
        @for (request of filteredContactRequests(); track request.id) {
          <div class="data-item">
            <input 
              type="checkbox" 
              class="complete-checkbox"
              [checked]="request.complete"
              (change)="toggleContactComplete(request)"
              title="Mark as complete"
            />
            <div class="item-content" [class.complete]="request.complete">
              <strong>{{ request.countryCode }} {{ request.mobileNumber }}</strong>
              <br>
              <small>Product ID: {{ request.productId }} | Date: {{ request.createdAt | date:'short' }}</small>
            </div>
          </div>
        }
        @if (filteredContactRequests().length === 0) {
          <div class="empty-message">No contact requests found</div>
        }
      </div>
    </div>
  </div>
</div>
